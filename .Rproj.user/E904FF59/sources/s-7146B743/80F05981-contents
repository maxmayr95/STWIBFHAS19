library(openxlsx)
schoolData = read.xlsx(xlsxFile = './STWI_SchoolData.xlsx')
#schoolData = read.xlsx(xlsxFile = './../Lesson 3/STWI_SchoolData.xlsx')

attach(schoolData)

#1

meanHeightBoys = mean(height[gender=='M'])
meanHeightGirls = mean(height[gender=='F'])

countGirlsTallerThanMeanHeightOfBoys = length(height[gender=="F" & height > meanHeightBoys])
countBoysSmallerThanMeanHeightOfGirls = length(height[gender=="M" & height < meanHeightGirls])

#2 M&M Jar
meanJar = mean(jar)
datesOfBirth = as.Date(dob,origin='1899-12-30')
datesOfBirth[abs(jar-557)==min(abs(jar-557))]

numbersPeopleCloserToActualJarValue = length(jar[abs(jar-557)<abs(jar-meanJar)])

#3 Dans salary
dansEarning = c(100,110,120)
mean(dansEarning)

#4 sarahs investment 
investment = c(5,10,15,20)
average = ((1.05*1.1*1.15*1.20)^(1/4) * 100)-100

#5 Formula 1
averagePerLap = 3/(1/150+1/130+1/175)

#6

median(jar)
mean(jar)

median(fruit)
mean(fruit)

median(distance)
mean(distance)

#8 What is the mean cost of a present for a sibling for a member of this class?
onlySibling = present[siblings>1]
mean(onlySibling) #why it's wrong

#9 

rangeHeight = range(height)
diffRange = rangeHeight[2]-rangeHeight[1]

#10 interquartile 

quantile(height,0.75)-quantile(height,0.25)

calculateInterquantile(height)               

quantile(maths,0.75)-quantile(maths,0.25)
quantile(cash,0.75)-quantile(cash,0.25)

#11 Find the standard deviation (as a sample) of the following lists: height,maths,cash

sqrt(sum((height-mean(height))^2)/(length(height)-1))
sd(height)
sqrt(sum((maths-mean(maths))^2)/(length(maths)-1))
sqrt(sum((cash-mean(cash))^2)/(length(cash)-1))

#12 Verify whether the empirical rule holds for the following data sets:
dnorm(height,mean = mean(height),sd=sqrt(sum((height-mean(height))^2)/(length(height)-1)),log = FALSE)
#???????????????????????????????????

#13 Calculate the coefficient of variation of the following data sets
sd(height)/mean(height)*100
calculateCoefficientOfVariation(height)
sd(maths)/mean(maths)*100
sd(cash)/mean(cash)*100

#14
# Intercontinental Hotels Group (IHG) owns and runs several chains of hotels,
# including Holiday Inn, in 100-plus countries across the world. The data
# found in IHG.xlsx shows customer ratings (out of 5) for Holiday Inn
# hotels in 25 large European cities (ihg.com, March 2015).

ihg = read.xlsx(xlsxFile = './IHG.xlsx')
attach(ihg)
#Compute the mean and median.
mean(Customer.ratings)
mean(Google.reviews)

median(Customer.ratings)
median(Google.reviews)
#Compute the 85th percentile.
quantile(Customer.ratings, 0.85)


#15

# Police records show the following numbers of daily crime reports for a
# sample of days during the winter months and a sample of days during the
# summer months.
# Winter: 18 20 15 16 21 20 12 16 19 20
# Summer: 28 18 24 32 18 29 23 38 28 18

winter = c(18,20,15,16,21,20,12,16,19,20)
summer = c(28,18,24,32,18,29,23,38,28,18)

#Compute the range and interquartile range for each period.
#???????????????????????????????
quantile(winter,0.75)-quantile(winter,0.25)

rangeWinter = range(winter)
rangeWinter[2]-rangeWinter[1]
max(winter)-min(winter)

quantile(summer,0.75)-quantile(summer,0.25)

#???????????????????????????????

#16 Verify the mean and standard deviation (as a sample) of the z-scores for the following lists:
height.z = (height-mean(height))/sd(height)
sd(height.z)


#17 Calculate the skewness for the following lists:


lengthHeight = length(height)
skewnessHeight = lengthHeight/((lengthHeight-1)*(lengthHeight-2))*sum(height.z^3)
skewnessHeight2 = calculateSkewness(height)

lengthFruit = length(fruit)
fruit.z = (fruit-mean(fruit))/sd(fruit)
skewnessFruit = lengthFruit/((lengthFruit-1)*(lengthFruit-2))*sum(fruit.z^3)

hairGirls = hair[gender=='F']
lenghtHairGirls = length(hairGirls)
hairGirls.z = (hairGirls-mean(hairGirls))/sd(hairGirls)
skewnessHairGirls = lenghtHairGirls/((lenghtHairGirls-1)*(lenghtHairGirls-2))*sum(hairGirls.z^3)

#18 Create side by side boxplots to compare the following pairs of data:
boxplot(hair~gender)

boxplot(distance~transport)

#19 Compare the following pairs of data by way of a scatter plot, a line of best fit and the correlation coefficient:
plot(height, foot, main="Scatterplot Height Foot", xlab="Height ", ylab="Foot") 
abline(lm(foot ~ height))

plot(hair, foot, main="Scatterplot Hair Foot", xlab="Hair ", ylab="Foot") 
lines(cor(hair,foot), col="blue") # lowess line (x,y) 
abline(lm(foot ~ hair))

#20 Here we want to consider the association between height and hair with respect to the gender.
correlationHairGender = cor(height,hair)

correlationHairGenderGirls = cor(height[gender=='F'],hair[gender=="F"])
correlationHairGenderBoys = cor(height[gender=='M'],hair[gender=="M"])

#21 What can be said about the formula for covariance if both lists are of the same data?
#Sie entspricht dann der Definition für die Abweichung. Das heißt: Sxx = Sx.

#22-24 => estimating of plots

#25 In 2008, stock markets around the world lost value. The website www.owneverystock.com
# listed the percentage falls in stock market indices between the start of the
# year and the beginning of October. The data can be found in Stock.xlsx.
detach(schoolData)
stockData = read.xlsx(xlsxFile = './STOCK.xlsx')
attach(stockData)
#a
mean(stockData$`%.Fall`)
#b
quantile(`%.Fall`,0.75)
quantile(`%.Fall`,0.25)

boxplot(`%.Fall`) #no outliners


detach(stockData)

#26 Stock markets across the Eurozone tend to have mutual influences on each other. 
#The index levels of the German DAX index and the French CAC 40 index
#for the first 10 weeks of 2015 can be found in DAX CAC 2015.xlsx.



daxData = read.xlsx(xlsxFile = './DAX_CAC 2015.xlsx')
attach(daxData)
cor(DAX[!is.na(DAX)],CAC[!is.na(CAC)])

detach(daxData)